<form [formGroup]="workloadForm">
  <div class="firstStepContentWrapper">
    <div class="inputFieldFlex">
      <mat-form-field>
        <mat-select [formControl]="workloadForm.controls.tStaffCtrl" #singleSelect>
          @if (tStaff()) {
            @if (tStaff()?.length === 0) {
              <mat-option>
                Izveidojiet docentus!
              </mat-option>
            } @else {
              <mat-option>
                <ngx-mat-select-search [formControl]="workloadForm.controls.tStaffFilterCtrl"
                                       placeholderLabel="Meklēt personu"
                                       noEntriesFoundLabel="Persona nav atrasta">
                </ngx-mat-select-search>
              </mat-option>
              @for (tStaff of filteredTeachingStaff | async; track tStaff.teachingStaffId) {
                <mat-option [value]="tStaff.teachingStaffId">
                  {{ tStaff.rankFullName }}
                </mat-option>
              }
            }
          }
        </mat-select>
        @if (!tStaff()) {
          <mat-label>
            <em>Lādē datus...</em>
          </mat-label>
        } @else {
          <mat-label>Izvēlies docentu</mat-label>
        }
      </mat-form-field>
      <button mat-button routerLink="new-teaching-staff">Izveidot jaunu</button>
    </div>
    <div class="inputFieldFlex">
      <mat-form-field>
        <mat-select [formControl]="workloadForm.controls.courseCtrl" #singleSelect>
          @if (courses()) {
            @if (courses()?.length === 0) {
              <mat-option>
                Izveidojiet kursus!
              </mat-option>
            } @else {
              <mat-option>
                <ngx-mat-select-search [formControl]="workloadForm.controls.courseFilterCtrl"
                                       placeholderLabel="Meklēt kursu"
                                       noEntriesFoundLabel="Kurss Nav atrasts">
                </ngx-mat-select-search>
              </mat-option>
              @for (course of filteredCourses | async; track course.courseId) {
                <mat-option [value]="course.courseId">
                  {{ course.courseName }}
                </mat-option>
              }
            }
          }
        </mat-select>
        @if (!courses()) {
          <mat-label>
            <em>Lādē datus...</em>
          </mat-label>
        } @else {
          <mat-label>Izvēlies kursu</mat-label>
        }
      </mat-form-field>
      <button mat-button routerLink="new-course">Izveidot jaunu</button>
    </div>
    <div class="inputFieldFlex">
      <mat-form-field>
        <mat-select [formControl]="workloadForm.controls.myClassCtrl" [multiple]="true" #multiSelect>
          @if (myClasses()) {
            @if (myClasses()?.length === 0) {
              <mat-option>
                Izveidojiet kursus!
              </mat-option>
            } @else {
              <mat-option>
                <ngx-mat-select-search [formControl]="workloadForm.controls.myClassFilterCtrl"
                                       placeholderLabel="Meklēt klasi"
                                       noEntriesFoundLabel="Klase nav atrasta">
                </ngx-mat-select-search>
              </mat-option>
              @for (myClass of filteredMyClasses | async; track myClass.classId) {
                <mat-option [value]="myClass.classId">
                  {{ myClass.classNameAndYear }}
                </mat-option>
              }
            }
          }
        </mat-select>
        @if (!myClasses()) {
          <mat-label>
            <em>Lādē datus...</em>
          </mat-label>
        } @else {
          <mat-label>Izvēlies klasi</mat-label>
        }
      </mat-form-field>
      <button mat-button routerLink="new-class">Izveidot jaunu</button>
    </div>
    <div class="inputFieldFlex">
      <mat-form-field>
        <mat-select [formControl]="workloadForm.controls.academicRankCtrl">
          @if (academicRanks()) {
            @if (academicRanks()?.length === 0) {
              <mat-option>
                Izveidojiet amatus!
              </mat-option>
            } @else {
              @for (rank of academicRanks(); track rank.academicRankId) {
                <mat-option [value]="rank.academicRankId">
                  {{ rank.rankName }}
                </mat-option>
              }
            }
          }
        </mat-select>
        @if (!academicRanks()) {
          <mat-label>
            <em>Lādē datus...</em>
          </mat-label>
        } @else {
          <mat-label>Izvēlies amatu</mat-label>
        }
      </mat-form-field>
    </div>
    <div class="inputFieldFlex">
      <mat-form-field>
        <mat-select required [formControl]="workloadForm.controls.statusTypeCtrl">
          @if (statusTypes()) {
            @if (statusTypes()?.length === 0) {
              <mat-option>
                Izveidojiet statusus!
              </mat-option>
            } @else {
              @for (statusType of statusTypes(); track statusType.statusTypeId) {
                <mat-option [value]="statusType.statusTypeId">
                  {{ statusType.statusTypeName }}
                </mat-option>
              }
            }
          }
        </mat-select>
        @if (!statusTypes()) {
          <mat-label>
            <em>Lādē datus...</em>
          </mat-label>
        } @else {
          <mat-label>Izvēlies statusu</mat-label>
        }
      </mat-form-field>
    </div>
  </div>
  <div style="display: flex">
    <button mat-raised-button type="button" routerLink="..">Cancel</button>
    <button mat-raised-button type="submit" [disabled]="workloadForm.invalid">
      Izveidot
    </button>
  </div>
</form>

<app-preview-input-data
  [tStaff]="selectedTeachingStaff()"
  [courses]="selectedCourse()"
  [myClasses]="selectedMyClasses()"
  [academicRank]="selectedAcademicRank()"
  [statusType]="selectedStatusType()"
  [displayedColumns]="columns()">
</app-preview-input-data>
<router-outlet (activate)="subscribeToChildEmitter($event)"/>

